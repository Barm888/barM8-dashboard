angular.module('app').controller('scanIdsController',['$scope','CurrentVisit','$state','$http','$rootScope','Business','VisitDateCustomer',function($scope,CurrentVisit,$state,$http,$rootScope,Business,VisitDateCustomer){if(!$scope.userId){$scope.userId=$rootScope.currentUser.id}
$scope.useremail=$rootScope.currentUser.email;$scope.userId="";$scope.isBusinessSelected=!1;if($rootScope.currentUser.email=="admin@barm8.com.au"){Business.find({filter:{where:{status:"approved"},"fields":["businessName","id","email"]}}).$promise.then((res)=>{$scope.businessDelection=res;$scope.userId=$rootScope.currentUser.id},(err)=>{console.log(JSON.stringify())})}
else{$scope.userId=$rootScope.currentUser.id}
$scope.getBusinessName=()=>{return $scope.businessDelection};var barDailyLive={"series":["Scan"],"data":[[1,2,0,2,1,1,1,0,3,8,1,2,0,1,1,2,1,2,2,3,1,2,0,0]],"labels":['00-01AM','01-02AM','02-03AM','03-04AM','04-05AM','05-06AM','06-07AM','07-08AM','08-09AM','09-10AM','10-11AM','11-12AM','12-01PM','01-02PM','02-03PM','03-04PM','04-05PM','05-06PM','06-07PM','07-08PM','08-09PM','09-10PM','10-11PM','11-12PM'],"colours":[{backgroundColor:'rgba(254, 191, 75, 1)',pointBackgroundColor:'rgba(59, 89, 152,1)',borderColor:'rgba(51,51,51,1)',pointBorderColor:'rgba(255,255,255,1)',pointHoverBorderColor:'rgba(255,255,255,1)'}],options:{responsive:!0,legend:{display:!0},hover:{mode:'label'},scales:{xAxes:[{display:!0}],yAxes:[{display:!0,ticks:{beginAtZero:!0,steps:1,stepValue:1,max:20}}]},title:{display:!0,text:'Customer Scan per hour'}}};$scope.barDaily=barDailyLive;var pieDailyGender={"series":["Scan"],"data":[[40,50]],"labels":["Male","Female"],"colours":[{fill:!0,backgroundColor:['#f27521','#29ae2e']}],options:{responsive:!0,legend:{display:!0},hover:{mode:'label'},title:{display:!0,text:'Male & Female'}}};$scope.pieDailyG=pieDailyGender;$scope.ownerId;$scope.BusinessSelected=(arg)=>{$("#businessErr").text('');if(arg=='scans'){if($("#autocompleteBusiness").data('id')){$scope.ownerId=$("#autocompleteBusiness").data('id');arg=$("#autocompleteBusiness").data('id');$scope.isBusinessSelected=!0;if($("#businessSubmit").hasClass('businessSubmit')){$("#businessSubmit").html('<i class="fa fa-check" aria-hidden="true"></i>&nbsp;&nbsp;Reset');$("#businessSubmit").removeClass('businessSubmit').addClass('businessReset')}}else{$("#businessErr").text('Please select the Business name')}}};$scope.scan={};$scope.customer={};$scope.filter={};$scope.customerDetails=[];$scope.searchSubmit=()=>{$("#page-wrapper").css({"opacity":"0.1"});$scope.customerDetails=[];if($scope.ownerId){VisitDateCustomer.find({filter:{where:{"visitse.ownerId":$scope.ownerId},include:{relation:"customer"},order:"isCreate desc"}}).$promise.then((res)=>{if(res&&res.length>0){res=res.filter(m=>m.customer&&m.visitse);for(let visit of res){if(visit.visitse&&visit.visitse.length>0){for(let scan of visit.visitse[0].scanse){scan.customer=visit.customer;$scope.customerDetails.push(scan)}
$("#page-wrapper").css({"opacity":""})}else{$("#page-wrapper").css({"opacity":""})}}}else{$("#page-wrapper").css({"opacity":""})}})}else{$("#page-wrapper").css({"opacity":""})}}}])